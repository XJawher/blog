webpack 里面涉及到的知识点有很多个，知道多少写多少吧。

## loader 和 plugin

webpack 中很重要的两个知识点就是 loader 和 plugin 。
**loader**：是一个函数，将函数中接收的内容进行转换并返回转换的结果。
**plugin**：插件， webpack 会在打包的过程中广播出有很多事件，plugin 会检测到这些事件，利用这些广播事件然后做一些适合项目打包的事情，对 webpack 的能力是一种扩展。

loader 在 module.rules 中配置，作为模块的解析规则，是类型是数组，数组内的每一项是一个对象，对象中包含的属性有 test 类型文件，loader，option 参数等。

plugin 在 plugins 中配置，类型是数组，每一项是一个 Plugin 实例，参数都是通过构造函数传入。

## webpack 的打包原理

webpack 打包的过程是一个串行的过程，从启动到结束会依次执行如下的流程

1. 初始化参数，把配置文件和 shell 中出入的参数做合并处理。得到最终的参数。
2. 开始编译，用 1 得到的参数，初始化 compiler 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译
3. 确定入口，根据配置中的 enter 找到所有的入口文件。
4. 编译模块，从入口文件出发。调用所有的 loader 对模块进行翻译，再找到模块依赖的模块，递归本步骤，直到所有入口依赖的模块都经过 loader 的编译处理。等到翻译完所有的模块，这时候就会得到模块翻译完的内容和模块之间的依赖关系。
5. 输出资源，根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 chunk，再把每个 chunk 转换成一个单独的文件加入到输出列表中，这一步是可以改变输出内容的最后步骤。
6. 输出完成，在确定好输出的资源以后，根据配置文件中确定的路径和文件名，把内容写入到文件系统中。

webpack 在以上的打包过程中，会在特定的时间点广播出特定的事件，这时候插件在监听到某个事件后会执行某些我们写好的逻辑。

## 热更新

HMR 的核心就是客户端从服务端去拉更新后的文件，准确的说就是 chunk diff，webpack-dev-server WDS 和浏览器之间维护了一个 websock。当本地资源发生了变化的时候，WDS 会向浏览器推送资源，并带上构建时候的 hash，让客户和上一次的资源进行对比，对比完成后根据差异会触发请求来获取变化的文件列表和 hash，这样客户端就可以继续向服务端发起 JSONP 请求这样就可以获取这个 chunk 的增量更新。
[webpack hmr 原理](https://zhuanlan.zhihu.com/p/30669007)
